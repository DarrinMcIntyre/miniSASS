<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>miniSASS</title>
    <!--OpenLayers-->
    <script src="{{ STATIC_URL }}openlayers/OpenLayers.js" type="text/javascript"></script>
    <!--Google Maps API-->
    <script src="http://maps.google.com/maps/api/js?v=3&amp;sensor=false"></script>
    <!--ExtJS-->
    <script src="{{ STATIC_URL }}js/ext-3.4.0/adapter/ext/ext-base.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/ext-3.4.0/ext-all.js" type="text/javascript"></script>
    <link href="{{ STATIC_URL }}js/ext-3.4.0/resources/css/ext-all.css" rel="stylesheet" type="text/css"/>
    <!--GeoExt-->
    <script src="{{ STATIC_URL }}js/GeoExt/lib/GeoExt.js" type="text/javascript"></script>
    <link href="{{ STATIC_URL }}js/GeoExt/resources/css/geoext-all-debug.css" rel="stylesheet" type="text/css"/>
    <!--miniSASS-->
    <script src="{{ STATIC_URL }}js/minisass.js" type="text/javascript"></script>
    <link href="{{ STATIC_URL }}css/monitor_stylesheet.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id=sidepanel>
      <div id="layertree"></div>
      <div id="legend">
        <table id="legend_table">
          <tr>
            <td class="map_legend_icon"><img src="{{ STATIC_URL }}img/icon_crab_n.png" id="legend_icon1" alt="" title=""/></td>
            <td class="map_legend_text">Unmodified<br />(NATURAL condition)</td>
          </tr>
          <tr>
            <td class="map_legend_icon"><img src="{{ STATIC_URL }}img/icon_crab_g.png" id="legend_icon2" alt="" title=""/></td>
            <td class="map_legend_text">Largely natural/few modifications<br />(GOOD condition)</td>
          </tr>
          <tr>
            <td class="map_legend_icon"><img src="{{ STATIC_URL }}img/icon_crab_f.png" id="legend_icon3" alt="" title=""/></td>
            <td class="map_legend_text">Moderately modified<br />(FAIR condition)</td>
          </tr>
          <tr>
            <td class="map_legend_icon"><img src="{{ STATIC_URL }}img/icon_crab_p.png" id="legend_icon4" alt="" title=""/></td>
            <td class="map_legend_text">Largely modified<br />(POOR condition)</td>
          </tr>
          <tr>
            <td class="map_legend_icon"><img src="{{ STATIC_URL }}img/icon_crab_v.png" id="legend_icon5" alt="" title=""/></td>
            <td class="map_legend_text">Seriously/critically modified<br />(VERY POOR condition)</td>
          </tr>
        </table>
      </div> <!--legend-->
      <div id="input_obs">
        <div id="input_buttons">
          <img src="{{ STATIC_URL }}img/button_obs_info.png" alt="" id="id_obs_info" title="Click a crab symbol on the map for details of the observation" style="cursor:pointer;"/>
          <img src="{{ STATIC_URL }}img/button_obs_add.png" alt="" id="id_obs_add" title="Enter a miniSASS observation at a new site" style="cursor:pointer;"/>
          <br />
          <img src="{{ STATIC_URL }}img/button_obs_map.png" alt="" id="id_obs_map" title="Enter a miniSASS observation by clicking on a new site on the map" style="cursor:pointer;"/>
          <img src="{{ STATIC_URL }}img/button_obs_list.png" alt="" id="id_obs_list" title="Enter a miniSASS observation by selecting a site from a list" style="cursor:pointer;"/>
        </div> <!--input_buttons-->
      </div> <!--input_obs-->
      <div id="messages">
      </div> <!--messages-->
        {% if site_form.errors %}
          Site errors<br />
          {% for error in site_form.errors %}
            Error: {{ error }}<br />
          {% endfor %}
        {% endif %}
        {% if coords_form.errors %}
          Coordinate errors<br />
          {% for error in coords_form.errors %}
            Error: {{ error }}<br />
          {% endfor %}
        {% endif %}
        {% if observation_form.errors %}
          Observation errors<br />
          {% for error in observation_form.errors %}
            Error: {{ error }}<br />
          {% endfor %}
        {% endif %}
    </div> <!--sidepanel-->
    <div id="map"></div> <!--map-->
    <div id="data_window" class="x-hidden">
      <div class="x-window-header">miniSASS Data Input</div>
      <div id="data_panel">
        <form action="/monitor/" method="post" id="dataform">{% csrf_token %}
          <table>
            <tr>
              <td>
                <table id="data_table_left">
                  <tr><td><label for="id_obs_date">Date:</label></td><td>{{ observation_form.obs_date }}</td></tr>
                  <tr><td><label for="id_name">Collector&apos;s name:</label></td><td>{{ observation_form.user_name }}</td></tr>
                  <tr><td><label for="id_name">River name:</label></td><td>{{ site_form.name }}</td></tr>
                  <tr><td><label for="id_description">Site description:</label></td><td>{{ site_form.description }}</td></tr>
                  <tr><td><label for="id_latitude">Latitude (S):</label></td>
                    <td>
                      {{ coords_form.latitude }}
                      <input type="text" name="lat_d" id="id_lat_d" style="display: none;" size="2"/>
                      <input type="text" name="lat_m" id="id_lat_m" style="display: none;" size="2"/>
                      <input type="text" name="lat_s" id="id_lat_s" style="display: none;" size="3"/>
                    </td>
                  </tr>
                  <tr><td><label for="id_longitude">Longitude (E):</label></td>
                    <td>
                      {{ coords_form.longitude }}
                      <input type="text" name="lon_d" id="id_lon_d" style="display: none;" size="2"/>
                      <input type="text" name="lon_m" id="id_lon_m" style="display: none;" size="2"/>
                      <input type="text" name="lon_s" id="id_lon_s" style="display: none;" size="3"/>
                    </td>
                  </tr>
                  <tr><td></td>
                    <td>
                      <input type="radio" name="coord_format" id="Decimal" value="Decimal" onclick="coords('Decimal');" checked="checked"/>Decimal degrees
                      <br />
                      <input type="radio" name="coord_format" id="DMS" value="DMS" onclick="coords('DMS');"/>Degrees/Minutes/Seconds
                    </td>
                  </tr>
                  <tr><td><label for="id_comment">Comments/notes:</label></td><td>{{ observation_form.comment }}</td></tr>
                  <tr><td><label for="id_river_cat">River category:</label></td>
                    <td>
                      {{ site_form.river_cat }}
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <table id="data_table_right">
                  <tr><th></th><th>Groups</th><th>Sensitivity<br />Score</th></tr>
                  <tr><td>{{ observation_form.flatworms }}</td><td class="tdlabel"><label for="id_flatworms">{{ observation_form.flatworms.label }}:</label></td><td id="flatworms" class="tdscore">3</td></tr>
                  <tr><td>{{ observation_form.worms }}</td><td class="tdlabel"><label for="id_worms">{{ observation_form.worms.label }}:</label></td><td id="worms" class="tdscore">2</td></tr>
                  <tr><td>{{ observation_form.leeches }}</td><td class="tdlabel"><label for="id_leeches">{{ observation_form.leeches.label }}:</label></td><td id="leeches" class="tdscore">2</td></tr>
                  <tr><td>{{ observation_form.crabs_shrimps }}</td><td class="tdlabel"><label for="id_crabs_shrimps">{{ observation_form.crabs_shrimps.label }}:</label></td><td id="crabs_shrimps" class="tdscore">6</td></tr>
                  <tr><td>{{ observation_form.stoneflies }}</td><td class="tdlabel"><label for="id_stoneflies">{{ observation_form.stoneflies.label }}:</label></td><td id="stoneflies" class="tdscore">17</td></tr>
                  <tr><td>{{ observation_form.minnow_mayflies }}</td><td class="tdlabel"><label for="id_minnow_mayflies">{{ observation_form.minnow_mayflies.label }}:</label></td><td id="minnow_mayflies" class="tdscore">5</td></tr>
                  <tr><td>{{ observation_form.other_mayflies }}</td><td class="tdlabel"><label for="id_other_mayflies">{{ observation_form.other_mayflies.label }}:</label></td><td id="other_mayflies" class="tdscore">11</td></tr>
                  <tr><td>{{ observation_form.damselflies }}</td><td class="tdlabel"><label for="id_damselflies">{{ observation_form.damselflies.label }}:</label></td><td id="damselflies" class="tdscore">4</td></tr>
                  <tr><td>{{ observation_form.dragonflies }}</td><td class="tdlabel"><label for="id_dragonflies">{{ observation_form.dragonflies.label }}:</label></td><td id="dragonflies" class="tdscore">6</td></tr>
                  <tr><td>{{ observation_form.bugs_beetles }}</td><td class="tdlabel"><label for="id_bugs_beetles">{{ observation_form.bugs_beetles.label }}:</label></td><td id="bugs_beetles" class="tdscore">5</td></tr>
                  <tr><td>{{ observation_form.caddisflies }}</td><td class="tdlabel"><label for="id_caddisflies">{{ observation_form.caddisflies.label }}:</label></td><td id="caddisflies" class="tdscore">9</td></tr>
                  <tr><td>{{ observation_form.true_flies }}</td><td class="tdlabel"><label for="id_true_flies">{{ observation_form.true_flies.label }}:</label></td><td id="true_flies" class="tdscore">2</td></tr>
                  <tr><td>{{ observation_form.snails }}</td><td class="tdlabel"><label for="id_snails">{{ observation_form.snails.label }}:</label></td><td id="snails" class="tdscore">4</td></tr>
                  <tr><td></td><td class="tdlabel">Total score:</td><td id="id_total_score" class="tdtotal">0</td></tr>
                  <tr><td></td><td class="tdlabel">Number of groups:</td><td id="id_groups" class="tdtotal">0</td></tr>
                  <tr><td></td><td class="tdlabel">Average score:</td><td id="id_average_score" class="tdtotal">0.0</td></tr>
                </table>
              </td>
            </tr>
          </table>
          {{ site_form.the_geom.as_hidden }}
          <input type="hidden" name="score" id="id_score" value="0.0"/>
          <input type="hidden" name="flag" id="id_flag" value="clean"/>
          <input type="hidden" name="site" id="id_site" value="1"/>
          {{ map_form.zoom_level.as_hidden }}
          {{ map_form.centre_X.as_hidden }}
          {{ map_form.centre_Y.as_hidden }}
          {{ map_form.layers.as_hidden }}
        </form> <!--dataform-->
      </div>  <!--data_panel-->
    </div> <!--data_window-->

    <div id="site_list_window" class="x-hidden">
      <div class="x-window-header">Observation Site</div>
      <div id="site_list_panel">
        Please select a site from the list below:
        <select name="site_gid" id="id_site_gid">
          <option value="" selected="selected"></option>
          {% for site in sites %}
            <option value="{{ site.gid.value }}">{{ site.name.value }}</option>
          {% endfor %}
        </select>
      </div> <!--site_list_panel-->
    </div> <!--site_list_window-->
    <div id="site_data">
      {% for site in sites %}
        {% for field in site %}
          {{ field.as_hidden }}
        {% endfor %}
      {% endfor %}
    </div> <!--site_data-->
  </body>
</html>
